[tools]
bun = "1.3"
semgrep = "latest"

[tasks.dev]
description = "Run the CLI in development mode"
run = "bun run src/index.ts"

[tasks.build]
description = "Build the CLI binary"
run = "bun build src/index.ts --compile --outfile ralph-for-kiro"

[tasks.test]
alias = "t"
description = "Run tests"
run = "bun test"

[tasks."test:coverage"]
description = "Run tests with coverage"
run = "bun test --coverage"

[tasks."test:watch"]
description = "Run tests in watch mode"
run = "bun test --watch"

[tasks.lint]
description = "Run linter"
run = "bunx biome check src tests"

[tasks."lint:fix"]
description = "Run linter with auto-fix"
run = "bunx biome check src tests --write"

[tasks.format]
description = "Format code"
run = "bunx biome format src tests --write"

[tasks."format:check"]
description = "Check code formatting"
run = "bunx biome format src tests"

[tasks.typecheck]
description = "Run TypeScript type checking"
run = "bunx tsc --noEmit"

[tasks.install]
description = "Install dependencies"
run = "bun install"

# Security tasks
[tasks.audit]
description = "Scan dependencies for vulnerabilities"
run = "bun pm scan"

[tasks."security:auto"]
description = "Run Semgrep with auto-detection rules"
run = "semgrep scan --config auto src"

[tasks."security:owasp"]
description = "Run Semgrep with OWASP Top 10 rules"
run = "semgrep scan --config p/owasp-top-ten src"

[tasks."security:all"]
description = "Run all security scans"
depends = ["audit", "security:auto", "security:owasp"]
run = "echo 'All security scans complete'"
